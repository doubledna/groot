FROM go1.22.4 AS builder
WORKDIR /opt/
RUN rm -rf /opt/groot/
RUN git clone -b main xxx
WORKDIR /opt/groot/cmd/scheduler/
RUN go build -o groot main.go

FROM debian AS prod
ARG CONF_ENV
ENV CONF_ENV=prod
WORKDIR /opt/
RUN rm -rf /opt/groot/
COPY --from=builder /opt/groot/cmd/scheduler/groot .
CMD ["./groot"]
